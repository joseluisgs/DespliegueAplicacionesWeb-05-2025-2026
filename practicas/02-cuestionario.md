### 10 Preguntas de Investigación y Desarrollo

1.  **Análisis de Seguridad y Firewall en Modos FTP:** Investigue y compare los riesgos de seguridad y los desafíos de conectividad que introducen el **FTP Modo Activo** y el **FTP Modo Pasivo**. Explique detalladamente por qué el Modo Activo es bloqueado por el Firewall del Cliente y cómo el Modo Pasivo traslada el riesgo al Servidor (al requerir la apertura de un rango de puertos Q > 1023). Diseñe una simulación conceptual donde se demuestre cómo un administrador de red debe configurar las reglas NAT/Firewall en ambos escenarios.

2.  **Comparativa Profunda de Protocolos Seguros (FTPS vs. SFTP):** Realice un análisis comparativo entre **FTPS** (FTP sobre SSL/TLS) y **SFTP** (SSH File Transfer Protocol). Además de las diferencias en el protocolo base (FTP tradicional con cifrado vs. SSH), investigue las implicaciones prácticas de seguridad. ¿Por qué se considera que SFTP (que utiliza un único puerto 22) simplifica la configuración de *firewalls* en comparación con FTPS (que requiere la gestión de certificados y, a menudo, un rango de puertos pasivos)?.

3.  **Endurecimiento de VSFTPD mediante Chrooting:** El servidor VSFTPD utiliza la directiva `chroot_local_user=YES` para limitar a los usuarios locales a su directorio *home* (la "jaula"). Sin embargo, si la carpeta raíz de la jaula tiene permisos de escritura, VSFTPD prohíbe la conexión por seguridad, resultando en el error "500 OOPS". Investigue el origen de esta prohibición de seguridad y justifique cómo el uso de la directiva `allow_writeable_chroot=YES` soluciona el problema al permitir al usuario borrar y editar archivos sin acceder a datos sensibles del sistema o de otros usuarios.

4.  **Gestión de Usuarios Virtuales en VSFTPD:** Desarrolle un procedimiento detallado para la gestión de múltiples usuarios virtuales en un entorno VSFTPD que corre en Docker. La investigación debe cubrir la creación del archivo de texto `virtual_users.txt`, la utilización de la herramienta **`db_load`** para generar la base de datos hash (`virtual_users.db`) que utiliza VSFTPD para la autenticación, y los pasos necesarios para asegurar que el servidor reconozca los nuevos usuarios tras un reinicio del contenedor.

5.  **Implementación de Autenticación con Claves SSH para SFTP:** Analice el modelo de seguridad basado en **pares de claves criptográficas SSH** (`sftp_key` y `sftp_key.pub`) en un servidor SFTP. Explique la función de la **Clave Privada** (la "llave única" que no se debe compartir) y la **Clave Pública** (la "cerradura" puesta en el servidor). Investigue las ventajas de seguridad que ofrece este método sobre el uso de contraseñas tradicionales para prevenir ataques de fuerza bruta.

6.  **Optimización del Rango de Puertos Pasivos en Docker:** En una configuración Docker para VSFTPD en Modo Pasivo, se deben definir el rango de puertos tanto a nivel de contenedor (`PASV_MIN_PORT` y `PASV_MAX_PORT`) como en la exposición del *host* (`-p 21100-21110:21100-21110`). Investigue y justifique qué criterios se deben seguir para seleccionar el **rango de puertos Q** más pequeño posible, minimizando el riesgo de seguridad en el servidor, y cómo este rango debe correlacionarse obligatoriamente entre la configuración interna y la exposición externa de Docker.

7.  **Integración de FTP en Aplicaciones Web Modernas (Spring Boot/Apache Commons):** Investigue cómo la librería **`commons-net` de Apache** se utiliza en un servicio de backend como Spring Boot para la gestión remota de archivos vía FTP. Proponga un diseño de servicio que utilice esta librería para subir y descargar archivos, justificando por qué FTP puede ser una alternativa viable para ficheros muy grandes o que no requieren ser accesibles "muy rápidamente", en lugar de usar el almacenamiento local del servidor.

8.  **Gestión de UIDs y Permisos en Servidores SFTP Enjaulados:** Analice el problema de los Identificadores de Usuario (UIDs) en la configuración de un servidor SFTP con Docker (`atmoz/sftp`) cuando se comparten volúmenes con el *host*. Explique la importancia de hacer coincidir el ID de usuario del servidor (ejemplo, `1000` en el comando `miusuario::1000`) con el ID del usuario en la máquina *host*. ¿Cómo garantiza esta coincidencia que los archivos subidos al SFTP aparecerán con los permisos correctos en la carpeta del host, evitando el uso de comandos `sudo` para la edición?.

9.  **Relación entre Códigos de Respuesta FTP y Fallos Operacionales:** Los códigos de respuesta FTP utilizan un formato de tres dígitos, donde el primer dígito indica el éxito o el fallo (ej. `4yz` o `5yz` indican "No hay respuesta") y el segundo dígito categoriza el tipo de problema (ej. `x5z` se refiere al Sistema de Archivos). Investigue y formule un escenario donde un código de respuesta `550` (fallo de sistema de archivos) o similar podría manifestarse durante un intento de subir un archivo, relacionándolo con la configuración de permisos o la falla de la "jaula" (Chrooting) en el servidor.

10. **Implementación y Despliegue de FTPS (SSL/TLS):** Desarrolle un protocolo para la implementación segura de FTPS en un servidor VSFTPD. La investigación debe detallar los pasos para la generación de un **certificado autofirmado** utilizando OpenSSL (`vsftpd.key` y `vsftpd.crt`), y cómo se debe configurar el archivo `vsftpd_ssl.conf` para habilitar el cifrado SSL/TLS, incluyendo las directivas que apuntan a las claves generadas. Finalmente, explique por qué el cliente (como FileZilla) debe seleccionar la opción **"Requiere FTP explícito sobre TLS"** y aceptar la advertencia del certificado desconocido.